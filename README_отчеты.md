# Генератор ежемесячных отчетов по технической поддержке

Единый скрипт для автоматической генерации полного отчета по технической поддержке за любой месяц.

## Установка зависимостей

```bash
pip3 install matplotlib numpy
```

## Использование

```bash
python3 generate_monthly_report.py <месяц> <год> <путь_к_csv>
```

### Примеры

```bash
# Отчет за декабрь 2025
python3 generate_monthly_report.py 12 2025 "/Users/annarybkina/Downloads/Задачи-5 - Лист1.csv"

# Отчет за январь 2026
python3 generate_monthly_report.py 1 2026 "/Users/annarybkina/Downloads/Задачи-январь.csv"
```

## Параметры

- **месяц** — число от 1 до 12 (1 = январь, 12 = декабрь)
- **год** — год (например, 2025, 2026)
- **путь_к_csv** — полный путь к CSV файлу с данными за месяц

## Что включает отчет

Скрипт автоматически генерирует HTML отчет со всеми шагами:

1. **Статистика обращений за месяц**
   - Всего обращений
   - Внешние пользователи (prod)
   - Внутренние пользователи (dev/demo)
   - Итоги за год

2. **Динамика количества обращений по месяцам**
   - Таблица с данными за весь год
   - График динамики (столбчатая диаграмма + линия)

3. **Соотношение типов обращений**
   - Таблица с разбивкой по типам (Вопрос, Проблема, Пожелание)
   - Доля внешних от общего количества

4. **Динамика по типам (только внешние)**
   - Таблица по месяцам
   - График динамики по типам (столбчатая диаграмма)

5. **Выводы по динамике обращений**
   - Аналитические выводы по каждому типу
   - Сравнение с предыдущими месяцами
   - Итоговые выводы

6. **Таблицы по SLA**
   - Первая реакция (таблица + круговые диаграммы)
   - Время решения (таблица + круговые диаграммы)

7. **Общие итоги**
   - Общая статистика по SLA
   - Детализация по типам

## Формат CSV файла

CSV файл должен содержать следующие колонки:
- `Создана` — дата создания в формате "28 дек. 2025"
- `Тип` — тип обращения (Вопрос, Проблема, Пожелание)
- `Застройщик` — название застройщика (для определения внешний/внутренний)
- `Первая реакция` — время первой реакции в минутах
- `Время решения` — время решения в минутах

## Выходной файл

Отчет сохраняется в формате HTML:
```
Отчет_техподдержка_<месяц>_<год>.html
```

Например: `Отчет_техподдержка_декабрь_2025.html`

## Создание PDF

После генерации HTML отчета:

1. Откройте файл в браузере (Safari или Chrome)
2. Нажмите `Cmd+P` (Печать)
3. Внизу слева выберите "PDF" → "Сохранить как PDF"
4. Сохраните файл

## Дизайн

Отчет использует минималистичный дизайн:
- Белый фон, черный текст
- Простые таблицы с тонкими границами
- Четкая типографика
- Без декоративных элементов

## Примечания

- Скрипт автоматически определяет внешних/внутренних пользователей по полю "Застройщик"
- Внутренние: содержат "allio dev", "allio demo" или равны "demo"
- Внешние: все остальные
- Если matplotlib не установлен, отчет будет создан без графиков
